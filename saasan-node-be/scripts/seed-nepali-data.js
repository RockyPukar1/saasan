const knex = require('knex');
const path = require('path');

// Database configuration
const db = knex({
  client: 'pg',
  connection: {
    host: process.env.DB_HOST || 'localhost',
    port: process.env.DB_PORT || 5432,
    database: process.env.DB_NAME || 'saasan_db',
    user: process.env.DB_USER || 'saasan_user',
    password: process.env.DB_PASSWORD || 'saasan_password',
  },
});

// Authentic Nepali data
const nepaliData = {
  // Provinces and Districts
  provinces: [
    { id: 1, name: 'Koshi Province', name_nepali: 'рдХреЛрд╢реА рдкреНрд░рджреЗрд╢', capital: 'Biratnagar', capital_nepali: 'рд╡рд┐рд░рд╛рдЯрдирдЧрд░' },
    { id: 2, name: 'Madhesh Province', name_nepali: 'рдордзреЗрд╕ рдкреНрд░рджреЗрд╢', capital: 'Janakpur', capital_nepali: 'рдЬрдирдХрдкреБрд░' },
    { id: 3, name: 'Bagmati Province', name_nepali: 'рдмрд╛рдЧрдорддреА рдкреНрд░рджреЗрд╢', capital: 'Hetauda', capital_nepali: 'рд╣реЗрдЯреМрдбрд╛' },
    { id: 4, name: 'Gandaki Province', name_nepali: 'рдЧрдгреНрдбрдХреА рдкреНрд░рджреЗрд╢', capital: 'Pokhara', capital_nepali: 'рдкреЛрдЦрд░рд╛' },
    { id: 5, name: 'Lumbini Province', name_nepali: 'рд▓реБрдореНрдмрд┐рдиреА рдкреНрд░рджреЗрд╢', capital: 'Deukhuri', capital_nepali: 'рджреЗрдЙрдЦреБрд░реА' },
    { id: 6, name: 'Karnali Province', name_nepali: 'рдХрд░реНрдгрд╛рд▓реА рдкреНрд░рджреЗрд╢', capital: 'Birendranagar', capital_nepali: 'рд╡реАрд░реЗрдиреНрджреНрд░рдирдЧрд░' },
    { id: 7, name: 'Sudurpashchim Province', name_nepali: 'рд╕реБрджреВрд░рдкрд╢реНрдЪрд┐рдо рдкреНрд░рджреЗрд╢', capital: 'Godawari', capital_nepali: 'рдЧреЛрджрд╛рд╡рд░реА' }
  ],

  districts: [
    // Koshi Province
    { id: 1, name: 'Morang', name_nepali: 'рдореЛрд░рдЩ', province_id: 1 },
    { id: 2, name: 'Sunsari', name_nepali: 'рд╕реБрдирд╕рд░реА', province_id: 1 },
    { id: 3, name: 'Jhapa', name_nepali: 'рдЭрд╛рдкрд╛', province_id: 1 },
    { id: 4, name: 'Dhankuta', name_nepali: 'рдзрдирдХреБрдЯрд╛', province_id: 1 },
    { id: 5, name: 'Terhathum', name_nepali: 'рддреЗрд╣реНрд░рдереБрдо', province_id: 1 },
    
    // Madhesh Province
    { id: 6, name: 'Dhanusha', name_nepali: 'рдзрдиреБрд╖рд╛', province_id: 2 },
    { id: 7, name: 'Mahottari', name_nepali: 'рдорд╣реЛрддреНрддрд░реА', province_id: 2 },
    { id: 8, name: 'Sarlahi', name_nepali: 'рд╕рд░реНрд▓рд╛рд╣реА', province_id: 2 },
    { id: 9, name: 'Siraha', name_nepali: 'рд╕рд┐рд░рд╣рд╛', province_id: 2 },
    { id: 10, name: 'Saptari', name_nepali: 'рд╕рдкреНрддрд░реА', province_id: 2 },
    
    // Bagmati Province
    { id: 11, name: 'Kathmandu', name_nepali: 'рдХрд╛рдардорд╛рдбреМрдВ', province_id: 3 },
    { id: 12, name: 'Lalitpur', name_nepali: 'рд▓рд▓рд┐рддрдкреБрд░', province_id: 3 },
    { id: 13, name: 'Bhaktapur', name_nepali: 'рднрдХреНрддрдкреБрд░', province_id: 3 },
    { id: 14, name: 'Kavrepalanchok', name_nepali: 'рдХрд╛рднреНрд░реЗрдкрд▓рд╛рдЮреНрдЪреЛрдХ', province_id: 3 },
    { id: 15, name: 'Nuwakot', name_nepali: 'рдиреБрд╡рд╛рдХреЛрдЯ', province_id: 3 },
    
    // Gandaki Province
    { id: 16, name: 'Kaski', name_nepali: 'рдХрд╛рд╕реНрдХреА', province_id: 4 },
    { id: 17, name: 'Syangja', name_nepali: 'рд╕реНрдпрд╛рдЩрдЬрд╛', province_id: 4 },
    { id: 18, name: 'Tanahu', name_nepali: 'рддрдирд╣реБрдБ', province_id: 4 },
    { id: 19, name: 'Lamjung', name_nepali: 'рд▓рдордЬреБрдЩ', province_id: 4 },
    { id: 20, name: 'Gorkha', name_nepali: 'рдЧреЛрд░рдЦрд╛', province_id: 4 },
    
    // Lumbini Province
    { id: 21, name: 'Rupandehi', name_nepali: 'рд░реБрдкрдиреНрджреЗрд╣реА', province_id: 5 },
    { id: 22, name: 'Kapilvastu', name_nepali: 'рдХрдкрд┐рд▓рд╡рд╕реНрддреБ', province_id: 5 },
    { id: 23, name: 'Palpa', name_nepali: 'рдкрд╛рд▓реНрдкрд╛', province_id: 5 },
    { id: 24, name: 'Arghakhanchi', name_nepali: 'рдЕрд░реНрдШрд╛рдЦрд╛рдБрдЪреА', province_id: 5 },
    { id: 25, name: 'Gulmi', name_nepali: 'рдЧреБрд▓реНрдореА', province_id: 5 },
    
    // Karnali Province
    { id: 26, name: 'Surkhet', name_nepali: 'рд╕реБрд░реНрдЦреЗрдд', province_id: 6 },
    { id: 27, name: 'Jumla', name_nepali: 'рдЬреБрдореНрд▓рд╛', province_id: 6 },
    { id: 28, name: 'Kalikot', name_nepali: 'рдХрд╛рд▓рд┐рдХреЛрдЯ', province_id: 6 },
    { id: 29, name: 'Mugu', name_nepali: 'рдореБрдЧреБ', province_id: 6 },
    { id: 30, name: 'Humla', name_nepali: 'рд╣реБрдореНрд▓рд╛', province_id: 6 },
    
    // Sudurpashchim Province
    { id: 31, name: 'Kailali', name_nepali: 'рдХреИрд▓рд╛рд▓реА', province_id: 7 },
    { id: 32, name: 'Kanchanpur', name_nepali: 'рдХрдЮреНрдЪрдирдкреБрд░', province_id: 7 },
    { id: 33, name: 'Dadeldhura', name_nepali: 'рдбрдбреЗрд▓рдзреБрд░рд╛', province_id: 7 },
    { id: 34, name: 'Baitadi', name_nepali: 'рдмреИрддрдбреА', province_id: 7 },
    { id: 35, name: 'Darchula', name_nepali: 'рджрд╛рд░реНрдЪреБрд▓рд╛', province_id: 7 }
  ],

  // Political Parties
  parties: [
    { 
      id: 1, 
      name: 'Nepal Communist Party (UML)', 
      name_nepali: 'рдиреЗрдкрд╛рд▓ рдХрдореНрдпреБрдирд┐рд╖реНрдЯ рдкрд╛рд░реНрдЯреА (рдПрдорд╛рд▓реЗ)', 
      description_nepali: 'рдиреЗрдкрд╛рд▓рдХреЛ рдореБрдЦреНрдп рд░рд╛рдЬрдиреАрддрд┐рдХ рджрд▓рд╣рд░реВ рдордзреНрдпреЗ рдПрдХ',
      symbol: 'тШАя╕П', 
      color: '#FF6B35' 
    },
    { 
      id: 2, 
      name: 'Nepali Congress', 
      name_nepali: 'рдиреЗрдкрд╛рд▓реА рдХрд╛рдБрдЧреНрд░реЗрд╕', 
      description_nepali: 'рдиреЗрдкрд╛рд▓рдХреЛ рдкреНрд░рд╛рдЪреАрдирддрдо рд░ рдореБрдЦреНрдп рд░рд╛рдЬрдиреАрддрд┐рдХ рджрд▓',
      symbol: 'ЁЯМ│', 
      color: '#4ECDC4' 
    },
    { 
      id: 3, 
      name: 'Maoist Centre', 
      name_nepali: 'рдорд╛рдУрд╡рд╛рджреА рдХреЗрдиреНрджреНрд░', 
      description_nepali: 'рд╢рд╛рдиреНрддрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрдЫрд┐ рд╕реНрдерд╛рдкрд┐рдд рд░рд╛рдЬрдиреАрддрд┐рдХ рджрд▓',
      symbol: 'ЁЯФ┤', 
      color: '#E74C3C' 
    },
    { 
      id: 4, 
      name: 'Rastriya Prajatantra Party', 
      name_nepali: 'рд░рд╛рд╖реНрдЯреНрд░рд┐рдп рдкреНрд░рдЬрд╛рддрдиреНрддреНрд░ рдкрд╛рд░реНрдЯреА', 
      description_nepali: 'рд░рд╛рдЬрддрдиреНрддреНрд░ рд╕рдорд░реНрдердХ рд░рд╛рдЬрдиреАрддрд┐рдХ рджрд▓',
      symbol: 'ЁЯжЕ', 
      color: '#9B59B6' 
    },
    { 
      id: 5, 
      name: 'Janata Samajbadi Party', 
      name_nepali: 'рдЬрдирддрд╛ рд╕рдорд╛рдЬрд╡рд╛рджреА рдкрд╛рд░реНрдЯреА', 
      description_nepali: 'рдордзреЗрд╕реА рдЕрдзрд┐рдХрд╛рд░рдХрд╛ рд▓рд╛рдЧрд┐ рд▓рдбреНрдиреЗ рджрд▓',
      symbol: 'тЪЦя╕П', 
      color: '#F39C12' 
    },
    { 
      id: 6, 
      name: 'Loktantrik Samajbadi Party', 
      name_nepali: 'рд▓реЛрдХрддрд╛рдиреНрддреНрд░рд┐рдХ рд╕рдорд╛рдЬрд╡рд╛рджреА рдкрд╛рд░реНрдЯреА', 
      description_nepali: 'рд▓реЛрдХрддрдиреНрддреНрд░ рд░ рд╕рдорд╛рдЬрд╡рд╛рджрдХрд╛ рд▓рд╛рдЧрд┐ рдХрд╛рд░реНрдпрд░рдд рджрд▓',
      symbol: 'ЁЯдЭ', 
      color: '#3498DB' 
    },
    { 
      id: 7, 
      name: 'Independent', 
      name_nepali: 'рд╕реНрд╡рддрдиреНрддреНрд░', 
      description_nepali: 'рдХреБрдиреИ рдкрд╛рд░реНрдЯреАрдмрд╛рдЯ рд╕реНрд╡рддрдиреНрддреНрд░ рдЙрдореНрдореЗрджрд╡рд╛рд░',
      symbol: 'ЁЯжЛ', 
      color: '#95A5A6' 
    }
  ],

  // Politicians with authentic names and positions
  politicians: [
    // Federal Level
    {
      id: 1,
      fullName: 'Khadga Prasad Sharma Oli',
      fullNameNepali: 'рдЦрдбреНрдЧрдкреНрд░рд╕рд╛рдж рд╢рд░реНрдорд╛ рдУрд▓реА',
      positionId: 'prime_minister',
      constituencyId: 11, // Kathmandu
      partyId: 1,
      experienceYears: 25,
      age: 72,
      education: 'Master of Arts in Political Science',
      educationNepali: 'рд░рд╛рдЬрдиреАрддрд┐ рд╡рд┐рдЬреНрдЮрд╛рдирдорд╛ рд╕реНрдирд╛рддрдХреЛрддреНрддрд░',
      previousPositions: 'Former Prime Minister, Former Chief Minister of Province 1',
      previousPositionsNepali: 'рдкреВрд░реНрд╡ рдкреНрд░рдзрд╛рдирдордиреНрддреНрд░реА, рдкреНрд░рджреЗрд╢ рез рдХрд╛ рдкреВрд░реНрд╡ рдореБрдЦреНрдпрдордиреНрддреНрд░реА',
      achievements: 'Led Nepal through federal transition, Infrastructure development initiatives',
      achievementsNepali: 'рд╕рдВрдШреАрдп рд╕рдВрдХреНрд░рдордгрдХрд╛ рдмреЗрд▓рд╛ рдиреЗрдкрд╛рд▓рд▓рд╛рдИ рдиреЗрддреГрддреНрд╡, рдкреВрд░реНрд╡рд╛рдзрд╛рд░ рд╡рд┐рдХрд╛рд╕рдХрд╛ рдкрд╣рд▓рд╣рд░реВ',
      promises: ['Complete federal restructuring', 'Economic development', 'Social justice'],
      promisesNepali: ['рд╕рдВрдШреАрдп рдкреБрдирд░реНрдЧрдарди рдкреВрд░рд╛ рдЧрд░реНрдиреЗ', 'рдЖрд░реНрдерд┐рдХ рд╡рд┐рдХрд╛рд╕', 'рд╕рд╛рдорд╛рдЬрд┐рдХ рдиреНрдпрд╛рдп'],
      contactInfo: {
        email: 'kpsoli@parliament.gov.np',
        phone: '+977-1-4211234',
        address: 'Baluwatar, Kathmandu'
      }
    },
    {
      id: 2,
      fullName: 'Sher Bahadur Deuba',
      fullNameNepali: 'рд╢реЗрд░рдмрд╣рд╛рджреБрд░ рджреЗрдЙрд╡рд╛',
      positionId: 'member_parliament',
      constituencyId: 25, // Gulmi
      partyId: 2,
      experienceYears: 30,
      age: 76,
      education: 'Master of Arts in Economics',
      previousPositions: 'Former Prime Minister (4 times), Former Home Minister',
      achievements: 'Democracy restoration, Peace process leadership',
      promises: ['Democratic governance', 'Economic reforms', 'Social inclusion'],
      contactInfo: {
        email: 'sherdeuba@parliament.gov.np',
        phone: '+977-1-4215678',
        address: 'Budhanilkantha, Kathmandu'
      }
    },
    {
      id: 3,
      fullName: 'Pushpa Kamal Dahal',
      fullNameNepali: 'рдкреБрд╖реНрдкрдХрдорд▓ рджрд╛рд╣рд╛рд▓',
      positionId: 'member_parliament',
      constituencyId: 21, // Rupandehi
      partyId: 3,
      experienceYears: 35,
      age: 68,
      education: 'Bachelor of Arts',
      previousPositions: 'Former Prime Minister (2 times), Maoist leader',
      achievements: 'Peace process completion, Constitution drafting',
      promises: ['Social transformation', 'Economic justice', 'Inclusive development'],
      contactInfo: {
        email: 'prachanda@parliament.gov.np',
        phone: '+977-1-4219012',
        address: 'Maharajgunj, Kathmandu'
      }
    },
    
    // Provincial Level
    {
      id: 4,
      fullName: 'Hikmat Bahadur Karki',
      fullNameNepali: 'рд╣рд┐рдХрдорддрдмрд╣рд╛рджреБрд░ рдХрд╛рд░реНрдХреА',
      positionId: 'chief_minister',
      constituencyId: 1, // Morang
      partyId: 1,
      experienceYears: 20,
      age: 58,
      education: 'Master of Business Administration',
      previousPositions: 'Former Minister of Industry, Former Mayor',
      achievements: 'Industrial development in Province 1',
      promises: ['Economic growth', 'Employment generation', 'Infrastructure development'],
      contactInfo: {
        email: 'hkarki@province1.gov.np',
        phone: '+977-21-521234',
        address: 'Biratnagar, Morang'
      }
    },
    {
      id: 5,
      fullName: 'Rajendra Mahato',
      fullNameNepali: 'рд░рд╛рдЬреЗрдиреНрджреНрд░ рдорд╣рддреЛ',
      positionId: 'chief_minister',
      constituencyId: 6, // Dhanusha
      partyId: 5,
      experienceYears: 22,
      age: 55,
      education: 'Master of Arts in Political Science',
      previousPositions: 'Former Deputy Prime Minister, Former Minister',
      achievements: 'Madhesh rights advocacy, Social inclusion',
      promises: ['Madhesh development', 'Social justice', 'Regional autonomy'],
      contactInfo: {
        email: 'rmahato@madhesh.gov.np',
        phone: '+977-41-421234',
        address: 'Janakpur, Dhanusha'
      }
    },
    
    // Local Level
    {
      id: 6,
      fullName: 'Bidya Sundar Shakya',
      fullNameNepali: 'рд╡рд┐рджреНрдпрд╛ рд╕реБрдиреНрджрд░ рд╢рд╛рдХреНрдп',
      positionId: 'mayor',
      constituencyId: 11, // Kathmandu
      partyId: 2,
      experienceYears: 15,
      age: 48,
      education: 'Master of Engineering',
      previousPositions: 'Former Deputy Mayor, Engineer',
      achievements: 'Smart city initiatives, Waste management',
      promises: ['Smart Kathmandu', 'Clean environment', 'Digital governance'],
      contactInfo: {
        email: 'bshakya@kathmandu.gov.np',
        phone: '+977-1-4213456',
        address: 'Kathmandu Metropolitan City'
      }
    },
    {
      id: 7,
      fullName: 'Chiri Babu Maharjan',
      fullNameNepali: 'рдЪрд┐рд░реА рдмрд╛рдмреБ рдорд╣рд░реНрдЬрди',
      positionId: 'mayor',
      constituencyId: 12, // Lalitpur
      partyId: 1,
      experienceYears: 18,
      age: 52,
      education: 'Master of Arts in Sociology',
      previousPositions: 'Former Deputy Mayor, Social worker',
      achievements: 'Cultural preservation, Heritage management',
      promises: ['Heritage conservation', 'Cultural tourism', 'Local development'],
      contactInfo: {
        email: 'cmaharjan@lalitpur.gov.np',
        phone: '+977-1-5213456',
        address: 'Lalitpur Metropolitan City'
      }
    }
  ],

  // Current corruption cases with authentic scenarios
  corruptionCases: [
    {
      id: 1,
      title: 'Kathmandu Metropolitan City Road Construction Scam',
      titleNepali: 'рдХрд╛рдардорд╛рдбреМрдВ рдорд╣рд╛рдирдЧрд░рдкрд╛рд▓рд┐рдХрд╛ рд╕рдбрдХ рдирд┐рд░реНрдорд╛рдг рдШреЛрдЯрд╛рд▓рд╛',
      description: 'Investigation reveals that road construction contracts worth NPR 2.5 billion were awarded to companies without proper tender process. Roads constructed are already showing signs of damage within 6 months.',
      descriptionNepali: 'рдЕрдиреБрд╕рдиреНрдзрд╛рдирд▓реЗ рджреЗрдЦрд╛рдПрдХреЛ рдЫ рдХрд┐ реи.рел рдЕрд░реНрдм рд░реБрдкреИрдпрд╛рдБрдХреЛ рд╕рдбрдХ рдирд┐рд░реНрдорд╛рдг рдареЗрдХреНрдХрд╛ рдЙрдЪрд┐рдд рдЯреЗрдиреНрдбрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрд┐рдирд╛ рдХрдореНрдкрдиреАрд╣рд░реВрд▓рд╛рдИ рджрд┐рдЗрдПрдХреЛ рдЫред рдирд┐рд░реНрдорд┐рдд рд╕рдбрдХрд╣рд░реВ рем рдорд╣рд┐рдирд╛рдореИ рдХреНрд╖рддрд┐рдЧреНрд░рд╕реНрдд рджреЗрдЦрд┐рди рдерд╛рд▓реЗрдХрд╛ рдЫрдиреНред',
      category: 'financial_corruption',
      priority: 'high',
      status: 'under_investigation',
      amountInvolved: 2500000000,
      location: 'Kathmandu Metropolitan City',
      districtId: 11,
      reportedBy: 'Citizen Reporter',
      referenceNumber: 'KMC-2024-001',
      evidence: [
        'Construction contract documents',
        'Photographs of damaged roads',
        'Financial audit reports',
        'Witness testimonies'
      ],
      involvedOfficials: [
        'Former Deputy Mayor',
        'Engineering Department Head',
        'Contractor Company Owner'
      ],
      timeline: [
        { date: '2023-06-01', event: 'Contract awarded' },
        { date: '2023-12-01', event: 'Construction completed' },
        { date: '2024-01-15', event: 'First complaint filed' },
        { date: '2024-02-01', event: 'Investigation started' }
      ],
      impact: 'Poor road quality affects daily commute of 500,000+ citizens, waste of public funds',
      upvotesCount: 1250,
      downvotesCount: 45
    },
    {
      id: 2,
      title: 'Province 1 Education Budget Misuse',
      titleNepali: 'рдкреНрд░рджреЗрд╢ рез рд╢рд┐рдХреНрд╖рд╛ рдмрдЬреЗрдЯ рджреБрд░реБрдкрдпреЛрдЧ',
      description: 'Education budget of NPR 1.8 billion allocated for school infrastructure development has been misused. Investigation shows funds were diverted to non-educational purposes.',
      descriptionNepali: 'рд╡рд┐рджреНрдпрд╛рд▓рдп рдкреВрд░реНрд╡рд╛рдзрд╛рд░ рд╡рд┐рдХрд╛рд╕рдХрд╛ рд▓рд╛рдЧрд┐ рдЖрд╡рдВрдЯрд┐рдд рез.рео рдЕрд░реНрдм рд░реБрдкреИрдпрд╛рдБрдХреЛ рд╢рд┐рдХреНрд╖рд╛ рдмрдЬреЗрдЯ рджреБрд░реБрдкрдпреЛрдЧ рднрдПрдХреЛ рдЫред рдЕрдиреБрд╕рдиреНрдзрд╛рдирд▓реЗ рджреЗрдЦрд╛рдПрдХреЛ рдЫ рдХрд┐ рд░рдХрдо рдЧреИрд░-рд╢реИрдХреНрд╖рд┐рдХ рдЙрджреНрджреЗрд╢реНрдпрдХрд╛ рд▓рд╛рдЧрд┐ рдореЛрдбрд┐рдПрдХреЛ рдЫред',
      category: 'financial_corruption',
      priority: 'urgent',
      status: 'under_investigation',
      amountInvolved: 1800000000,
      location: 'Province 1',
      districtId: 1,
      reportedBy: 'Teachers Union',
      referenceNumber: 'P1-EDU-2024-002',
      evidence: [
        'Budget allocation documents',
        'Bank transaction records',
        'School inspection reports',
        'Teacher testimonies'
      ],
      involvedOfficials: [
        'Provincial Education Minister',
        'District Education Officer',
        'School Management Committee Members'
      ],
      timeline: [
        { date: '2023-07-01', event: 'Budget allocated' },
        { date: '2023-12-01', event: 'Funds disbursed' },
        { date: '2024-01-01', event: 'Irregularities noticed' },
        { date: '2024-02-15', event: 'Investigation launched' }
      ],
      impact: 'Affects education quality for 200,000+ students across Province 1',
      upvotesCount: 2100,
      downvotesCount: 120
    },
    {
      id: 3,
      title: 'Pokhara Municipality Land Scam',
      titleNepali: 'рдкреЛрдЦрд░рд╛ рдирдЧрд░рдкрд╛рд▓рд┐рдХрд╛ рдЬрдЧреНрдЧрд╛ рдШреЛрдЯрд╛рд▓рд╛',
      description: 'Municipal land worth NPR 500 million was illegally transferred to private developers. The land was designated for public park but sold without proper authorization.',
      descriptionNepali: 'рел рдХрд░реЛрдб рд░реБрдкреИрдпрд╛рдБрдХреЛ рдирдЧрд░рдкрд╛рд▓рд┐рдХрд╛рдХреЛ рдЬрдЧреНрдЧрд╛ рдЧреИрд░рдХрд╛рдиреВрдиреА рд░реВрдкрдорд╛ рдирд┐рдЬреА рд╡рд┐рдХрд╛рд╕рдХрд░реНрддрд╛рд╣рд░реВрд▓рд╛рдИ рд╕реНрдерд╛рдирд╛рдиреНрддрд░рдг рдЧрд░рд┐рдПрдХреЛ рдЫред рдЬрдЧреНрдЧрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкрд╛рд░реНрдХрдХрд╛ рд▓рд╛рдЧрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдерд┐рдпреЛ рддрд░ рдЙрдЪрд┐рдд рдЕрдзрд┐рдХрд╛рд░ рдмрд┐рдирд╛ рдмрд┐рдХреНрд░реА рдЧрд░рд┐рдПрдХреЛ рдЫред',
      category: 'land_corruption',
      priority: 'high',
      status: 'court_case',
      amountInvolved: 500000000,
      location: 'Pokhara Metropolitan City',
      districtId: 16,
      reportedBy: 'Environmental Activist',
      referenceNumber: 'PMC-LAND-2024-003',
      evidence: [
        'Land ownership documents',
        'Transfer deeds',
        'Municipal council minutes',
        'Environmental impact assessment'
      ],
      involvedOfficials: [
        'Mayor',
        'Land Revenue Officer',
        'Municipal Council Members',
        'Private Developer'
      ],
      timeline: [
        { date: '2023-03-01', event: 'Land designated for park' },
        { date: '2023-08-01', event: 'Illegal transfer occurred' },
        { date: '2023-12-01', event: 'Complaint filed' },
        { date: '2024-01-01', event: 'Court case filed' }
      ],
      impact: 'Loss of public green space, environmental degradation in Pokhara',
      upvotesCount: 890,
      downvotesCount: 78
    },
    {
      id: 4,
      title: 'Provincial Health Department Medicine Procurement Scam',
      titleNepali: 'рдкреНрд░рджреЗрд╢ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╡рд┐рднрд╛рдЧ рдФрд╖рдзрд┐ рдЦрд░рд┐рдж рдШреЛрдЯрд╛рд▓рд╛',
      description: 'Health department procured substandard medicines worth NPR 800 million at inflated prices. Medicines are either expired or of poor quality, endangering public health.',
      descriptionNepali: 'рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╡рд┐рднрд╛рдЧрд▓реЗ рео рдХрд░реЛрдб рд░реБрдкреИрдпрд╛рдБрдХреЛ рдирд┐рдореНрдирд╕реНрддрд░реАрдп рдФрд╖рдзрд┐ рдмрдвреА рдореВрд▓реНрдпрдорд╛ рдЦрд░рд┐рдж рдЧрд░реЗрдХреЛ рдЫред рдФрд╖рдзрд┐рд╣рд░реВ рдорд┐рддрд┐ рдирд╛рдШреЗрдХрд╛ рд╡рд╛ рдирд┐рдореНрдирд╕реНрддрд░реАрдп рдЫрдиреН, рдЬрд╕рд▓реЗ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реНрд╡рд╛рд╕реНрдереНрдпрд▓рд╛рдИ рдЬреЛрдЦрд┐рдордорд╛ рдкрд╛рд░реЗрдХреЛ рдЫред',
      category: 'health_corruption',
      priority: 'urgent',
      status: 'under_investigation',
      amountInvolved: 800000000,
      location: 'Lumbini Province',
      districtId: 21,
      reportedBy: 'Health Workers Union',
      referenceNumber: 'LP-HEALTH-2024-004',
      evidence: [
        'Procurement documents',
        'Medicine quality reports',
        'Price comparison analysis',
        'Hospital staff testimonies'
      ],
      involvedOfficials: [
        'Provincial Health Minister',
        'Procurement Officer',
        'Pharmacy Company Owner',
        'Hospital Administrator'
      ],
      timeline: [
        { date: '2023-09-01', event: 'Tender process started' },
        { date: '2023-10-01', event: 'Contract awarded' },
        { date: '2023-11-01', event: 'Medicines delivered' },
        { date: '2024-01-01', event: 'Quality issues reported' }
      ],
      impact: 'Public health risk, waste of healthcare budget, affects 1 million+ people',
      upvotesCount: 1650,
      downvotesCount: 95
    },
    {
      id: 5,
      title: 'Rural Municipality Development Fund Embezzlement',
      titleNepali: 'рдЧрд╛рдЙрдБрдкрд╛рд▓рд┐рдХрд╛ рд╡рд┐рдХрд╛рд╕ рдХреЛрд╖ рдЧрдмрди',
      description: 'Development fund of NPR 300 million allocated for rural infrastructure has been embezzled by local officials. The money was supposed to build roads, schools, and health posts.',
      descriptionNepali: 'рдЧреНрд░рд╛рдореАрдг рдкреВрд░реНрд╡рд╛рдзрд╛рд░рдХрд╛ рд▓рд╛рдЧрд┐ рдЖрд╡рдВрдЯрд┐рдд рей рдХрд░реЛрдб рд░реБрдкреИрдпрд╛рдБрдХреЛ рд╡рд┐рдХрд╛рд╕ рдХреЛрд╖ рд╕реНрдерд╛рдиреАрдп рдЕрдзрд┐рдХрд╛рд░реАрд╣рд░реВрд▓реЗ рдЧрдмрди рдЧрд░реЗрдХрд╛ рдЫрдиреНред рдпреЛ рд░рдХрдо рд╕рдбрдХ, рд╡рд┐рджреНрдпрд╛рд▓рдп, рд░ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдЪреМрдХреА рдирд┐рд░реНрдорд╛рдгрдХрд╛ рд▓рд╛рдЧрд┐ рдерд┐рдпреЛред',
      category: 'financial_corruption',
      priority: 'medium',
      status: 'investigation_complete',
      amountInvolved: 300000000,
      location: 'Karnali Province',
      districtId: 26,
      reportedBy: 'Local Citizen',
      referenceNumber: 'KP-RURAL-2024-005',
      evidence: [
        'Fund allocation records',
        'Bank statements',
        'Construction site photos',
        'Local resident testimonies'
      ],
      involvedOfficials: [
        'Rural Municipality Chairperson',
        'Account Officer',
        'Local Development Officer'
      ],
      timeline: [
        { date: '2023-04-01', event: 'Fund allocated' },
        { date: '2023-06-01', event: 'Embezzlement started' },
        { date: '2023-12-01', event: 'Irregularities noticed' },
        { date: '2024-02-01', event: 'Investigation completed' }
      ],
      impact: 'Delayed development, poor infrastructure, affects 50,000+ rural residents',
      upvotesCount: 720,
      downvotesCount: 45
    }
  ],

  // Current trending polls with authentic Nepali issues
  trendingPolls: [
    {
      id: 1,
      title: 'Do you think the current government is handling corruption effectively?',
      titleNepali: 'рдХреЗ рддрдкрд╛рдИрдВрд▓рд╛рдИ рд▓рд╛рдЧреНрдЫ рдХрд┐ рд╣рд╛рд▓рдХреЛ рд╕рд░рдХрд╛рд░рд▓реЗ рднреНрд░рд╖реНрдЯрд╛рдЪрд╛рд░рд▓рд╛рдИ рдкреНрд░рднрд╛рд╡рдХрд╛рд░реА рд░реВрдкрдорд╛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рдЧрд░рд┐рд░рд╣реЗрдХреЛ рдЫ?',
      description: 'Recent corruption cases have raised questions about government effectiveness in fighting corruption.',
      descriptionNepali: 'рд╣рд╛рд▓рдХрд╛ рднреНрд░рд╖реНрдЯрд╛рдЪрд╛рд░рдХрд╛ рдорд╛рдорд┐рд▓рд╛рд╣рд░реВрд▓реЗ рднреНрд░рд╖реНрдЯрд╛рдЪрд╛рд░ рд╡рд┐рд░реБрджреНрдз рд▓рдбрд╛рдИрдорд╛ рд╕рд░рдХрд╛рд░рдХреЛ рдкреНрд░рднрд╛рд╡рдХрд╛рд░рд┐рддрд╛рдХреЛ рдмрд╛рд░реЗрдорд╛ рдкреНрд░рд╢реНрди рдЙрдард╛рдПрдХрд╛ рдЫрдиреНред',
      options: [
        { id: 'yes', text: 'Yes, very effectively', textNepali: 'рд╣реЛ, рдзреЗрд░реИ рдкреНрд░рднрд╛рд╡рдХрд╛рд░реА', votes: 1250 },
        { id: 'somewhat', text: 'Somewhat effectively', textNepali: 'рдХреЗрд╣реА рдкреНрд░рднрд╛рд╡рдХрд╛рд░реА', votes: 2100 },
        { id: 'no', text: 'Not effectively', textNepali: 'рдкреНрд░рднрд╛рд╡рдХрд╛рд░реА рдЫреИрди', votes: 3450 },
        { id: 'not_sure', text: 'Not sure', textNepali: 'рдерд╛рд╣рд╛ рдЫреИрди', votes: 800 }
      ],
      totalVotes: 7600,
      category: 'governance',
      viral_potential: 'high',
      endDate: '2024-03-15T23:59:59Z',
      createdBy: 'Citizen Poll'
    },
    {
      id: 2,
      title: 'Should politicians above 65 years be required to retire?',
      titleNepali: 'рдХреНрдпрд╛ ремрел рд╡рд░реНрд╖ рдорд╛рдерд┐рдХрд╛ рд░рд╛рдЬрдиреАрддрд┐рдЬреНрдЮрд╣рд░реВрд▓рд╛рдИ рд╕реЗрд╡рд╛рдирд┐рд╡реГрддреНрдд рд╣реБрдиреБрдкрд░реНрдЫ?',
      description: 'Debate on age limit for political positions in Nepal.',
      descriptionNepali: 'рдиреЗрдкрд╛рд▓рдорд╛ рд░рд╛рдЬрдиреАрддрд┐рдХ рдкрджрдХрд╛ рд▓рд╛рдЧрд┐ рдЙрдореЗрд░ рд╕реАрдорд╛рдХреЛ рдмрд╣рд╕ред',
      options: [
        { id: 'yes', text: 'Yes, mandatory retirement', textNepali: 'рд╣реЛ, рдЕрдирд┐рд╡рд╛рд░реНрдп рд╕реЗрд╡рд╛рдирд┐рд╡реГрддреНрддрд┐', votes: 4200 },
        { id: 'no', text: 'No, age should not matter', textNepali: 'рд╣реЛрдЗрди, рдЙрдореЗрд░рд▓реЗ рдХреЗрд╣реА рдлрд░рдХ рдкрд░реНрджреИрди', votes: 2800 },
        { id: 'depends', text: 'Depends on health and performance', textNepali: 'рд╕реНрд╡рд╛рд╕реНрдереНрдп рд░ рдкреНрд░рджрд░реНрд╢рдирдорд╛ рдирд┐рд░реНрднрд░', votes: 1500 }
      ],
      totalVotes: 8500,
      category: 'political_reform',
      viral_potential: 'medium',
      endDate: '2024-03-20T23:59:59Z',
      createdBy: 'Youth Organization'
    },
    {
      id: 3,
      title: 'Which is the most pressing issue in Nepal today?',
      titleNepali: 'рдЖрдЬ рдиреЗрдкрд╛рд▓рдХреЛ рд╕рдмреИрднрдиреНрджрд╛ рдЬрд░реБрд░реА рдореБрджреНрджрд╛ рдХреЗ рд╣реЛ?',
      description: 'Citizens\' opinion on the most critical issues facing Nepal.',
      descriptionNepali: 'рдиреЗрдкрд╛рд▓рд▓рд╛рдИ рд╕рд╛рдордирд╛ рдЧрд░реНрдиреБрдкрд░реЗрдХрд╛ рд╕рдмреИрднрдиреНрджрд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореБрджреНрджрд╛рд╣рд░реВрдорд╛ рдирд╛рдЧрд░рд┐рдХрд╣рд░реВрдХреЛ рд░рд╛рдпред',
      options: [
        { id: 'corruption', text: 'Corruption', textNepali: 'рднреНрд░рд╖реНрдЯрд╛рдЪрд╛рд░', votes: 3200 },
        { id: 'economy', text: 'Economic development', textNepali: 'рдЖрд░реНрдерд┐рдХ рд╡рд┐рдХрд╛рд╕', votes: 2800 },
        { id: 'education', text: 'Education system', textNepali: 'рд╢рд┐рдХреНрд╖рд╛ рдкреНрд░рдгрд╛рд▓реА', votes: 1800 },
        { id: 'healthcare', text: 'Healthcare', textNepali: 'рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реЗрд╡рд╛', votes: 1200 },
        { id: 'infrastructure', text: 'Infrastructure', textNepali: 'рдкреВрд░реНрд╡рд╛рдзрд╛рд░', votes: 1000 }
      ],
      totalVotes: 10000,
      category: 'social_issues',
      viral_potential: 'high',
      endDate: '2024-03-25T23:59:59Z',
      createdBy: 'Saasan Team'
    }
  ]
};

async function seedNepaliData() {
  try {
    console.log('ЁЯЗ│ЁЯЗ╡ Seeding authentic Nepali data...\n');

    // Seed provinces
    console.log('ЁЯУН Seeding provinces...');
    await db('provinces').del();
    await db('provinces').insert(nepaliData.provinces);
    console.log(`тЬЕ Inserted ${nepaliData.provinces.length} provinces`);

    // Seed districts
    console.log('ЁЯПШя╕П Seeding districts...');
    await db('districts').del();
    await db('districts').insert(nepaliData.districts);
    console.log(`тЬЕ Inserted ${nepaliData.districts.length} districts`);

    // Seed political parties
    console.log('ЁЯПЫя╕П Seeding political parties...');
    await db('political_parties').del();
    await db('political_parties').insert(nepaliData.parties);
    console.log(`тЬЕ Inserted ${nepaliData.parties.length} political parties`);

    // Seed politicians
    console.log('ЁЯСе Seeding politicians...');
    await db('politicians').del();
    await db('politicians').insert(nepaliData.politicians);
    console.log(`тЬЕ Inserted ${nepaliData.politicians.length} politicians`);

    // Seed corruption cases
    console.log('ЁЯЪи Seeding corruption cases...');
    await db('corruption_reports').del();
    await db('corruption_reports').insert(nepaliData.corruptionCases);
    console.log(`тЬЕ Inserted ${nepaliData.corruptionCases.length} corruption cases`);

    // Seed trending polls
    console.log('ЁЯУК Seeding trending polls...');
    await db('polls').del();
    await db('polls').insert(nepaliData.trendingPolls.map(poll => ({
      id: poll.id,
      title: poll.title,
      title_nepali: poll.titleNepali,
      description: poll.description,
      description_nepali: poll.descriptionNepali,
      category: poll.category,
      viral_potential: poll.viral_potential,
      end_date: poll.endDate,
      created_by: poll.createdBy,
      total_votes: poll.totalVotes,
      created_at: new Date(),
      updated_at: new Date()
    })));

    // Insert poll options
    for (const poll of nepaliData.trendingPolls) {
      for (const option of poll.options) {
        await db('poll_options').insert({
          poll_id: poll.id,
          option_id: option.id,
          text: option.text,
          text_nepali: option.textNepali,
          votes: option.votes,
          created_at: new Date()
        });
      }
    }
    console.log(`тЬЕ Inserted ${nepaliData.trendingPolls.length} trending polls`);

    // Create admin user
    console.log('ЁЯСд Creating admin user...');
    const bcrypt = require('bcrypt');
    const hashedPassword = await bcrypt.hash('admin123', 10);
    
    await db('users').del().where('email', 'admin@saasan.np');
    await db('users').insert({
      id: 1,
      email: 'admin@saasan.np',
      password: hashedPassword,
      full_name: 'Saasan Admin',
      role: 'admin',
      is_verified: true,
      created_at: new Date(),
      updated_at: new Date()
    });
    console.log('тЬЕ Created admin user (email: admin@saasan.np, password: admin123)');

    // Create sample regular users
    console.log('ЁЯСе Creating sample users...');
    const sampleUsers = [
      {
        email: 'citizen1@saasan.np',
        password: await bcrypt.hash('password123', 10),
        full_name: 'Ram Bahadur Thapa',
        role: 'citizen',
        is_verified: true,
        created_at: new Date()
      },
      {
        email: 'citizen2@saasan.np',
        password: await bcrypt.hash('password123', 10),
        full_name: 'Sita Devi Maharjan',
        role: 'citizen',
        is_verified: true,
        created_at: new Date()
      },
      {
        email: 'reporter@saasan.np',
        password: await bcrypt.hash('password123', 10),
        full_name: 'Journalist Reporter',
        role: 'journalist',
        is_verified: true,
        created_at: new Date()
      }
    ];

    await db('users').insert(sampleUsers);
    console.log('тЬЕ Created sample users');

    console.log('\nЁЯОЙ Nepali data seeding completed successfully!');
    console.log('\nЁЯУК Summary:');
    console.log(`- ${nepaliData.provinces.length} Provinces`);
    console.log(`- ${nepaliData.districts.length} Districts`);
    console.log(`- ${nepaliData.parties.length} Political Parties`);
    console.log(`- ${nepaliData.politicians.length} Politicians`);
    console.log(`- ${nepaliData.corruptionCases.length} Corruption Cases`);
    console.log(`- ${nepaliData.trendingPolls.length} Trending Polls`);
    console.log('\nЁЯФС Login Credentials:');
    console.log('Admin: admin@saasan.np / admin123');
    console.log('Citizen: citizen1@saasan.np / password123');
    console.log('Journalist: reporter@saasan.np / password123');

  } catch (error) {
    console.error('тЭМ Error seeding data:', error);
    throw error;
  } finally {
    await db.destroy();
  }
}

// Run the seeding
if (require.main === module) {
  seedNepaliData()
    .then(() => {
      console.log('\nтЬЕ Seeding completed successfully!');
      process.exit(0);
    })
    .catch((error) => {
      console.error('\nтЭМ Seeding failed:', error);
      process.exit(1);
    });
}

module.exports = { seedNepaliData, nepaliData };
